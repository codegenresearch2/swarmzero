import os\nfrom datetime import datetime, timezone\nfrom typing import Any, List, Optional\nfrom pathlib import Path\nfrom llama_index.core.agent.runner.base import AgentRunner\nfrom llama_index.core.llms import ChatMessage, MessageRole\nfrom llama_index.core.memory import ChatMemoryBuffer\nfrom llama_index.core.schema import ImageDocument\nfrom swarmzero.database.database import DatabaseManager\nfrom swarmzero.filestore import BASE_DIR, FileStore\n\nfile_store = FileStore(BASE_DIR)\n\nclass ChatManager:\n    def __init__(self, llm: AgentRunner, user_id: str, session_id: str, enable_multi_modal: bool = False):\n        self.llm = llm\n        self.user_id = user_id\n        self.session_id = session_id\n        self.chat_store_key = f"{user_id}_{session_id}\